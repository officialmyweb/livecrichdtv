<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shaka Player</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.16.3/shaka-player.ui.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.16.3/controls.css" crossorigin="anonymous">

<style>
body {
  margin:0;
  background:#000;
}

#player{
  width:100%;
  background:#000;
  position:relative;
  aspect-ratio:16/9;
}

.shaka-logo{
  position:absolute;
  top:20px;
  left:30px;
  width:75px;
  height:auto;
  z-index:7000;
  pointer-events:none;
  opacity:0.95;
  border-radius:6px;
  background:rgba(255,255,255,0.02);
  padding:4px;
  box-shadow:0 6px 18px rgba(0,0,0,0.12);
}

@media (max-width:420px){
  .shaka-logo{
    width:36px;
    top:8px;
    left:8px;
  }
}
</style>
</head>

<body>

<div id="player"></div>

<!-- Load ONLY encoded data -->
<script src="https://lchdxfootball.pages.dev/sknzx.js"></script>

<script>

// --------- DECRYPTION LOGIC HERE ---------
const decryptionKey = "gf676rc7gr4grg78r6ag56gg8f76713f";

function decryptBase64(encodedStr, key) {
    const decodedBytes = atob(encodedStr);
    let decryptedStr = '';
    for (let i = 0; i < decodedBytes.length; i++) {
        decryptedStr += String.fromCharCode(
            decodedBytes.charCodeAt(i) ^ key.charCodeAt(i % key.length)
        );
    }
    return JSON.parse(decryptedStr);
}

// --------- GET ID ----------
function getURLParameter(name) {
    const params = new URLSearchParams(window.location.search);
    return params.get(name);
}

const id = getURLParameter("id");

if (!encodedChannelData[id]) {
    alert("Invalid ID! Redirecting...");
    window.location.href = "https://telegram.me/livecrichdofficial";
}

// --------- DECRYPT ----------
const selectedData = decryptBase64(encodedChannelData[id], decryptionKey);

// Your real JSON structure
const manifestUri = selectedData.ManifestURI;
const keyId = Object.keys(selectedData.DRMKeys)[0];
const key = selectedData.DRMKeys[keyId];

// --------- ORIGINAL SHAKA FUNCTION ----------
function initShakaPlayer(url, keyId, key) {

  const container = document.getElementById('player');
  container.innerHTML = '';

  const video = document.createElement('video');
  video.style.width = '100%';
  video.style.height = '100%';
  video.setAttribute('playsinline', '');
  video.setAttribute('autoplay', '');
  video.muted = true;

  container.appendChild(video);

  const player = new shaka.Player(video);

  player.configure({
    drm: {
      clearKeys: {
        [keyId]: key
      }
    }
  });

  const ui = new shaka.ui.Overlay(player, container, video);

  const uiConfig = {
      controlPanelElements: [
        'play_pause',
        'mute',
        'volume',
        'time_and_duration',
        'spacer',
        'picture_in_picture',
        'overflow_menu',
        'fullscreen'
      ],
      addSeekBar: true,
      seekBarColors: {
        base: 'rgba(255, 255, 255, 0.3)',
        buffered: 'rgba(255, 255, 255, 0.5)',
        played: 'rgba(6,182,212,0.9)'
      },
      volumeBarColors: {
        base: 'rgba(255,255,255,0.3)',
        level: 'rgba(6,182,212,0.9)'
      }
  };

  ui.configure(uiConfig);

  player.load(url).then(() => {
    video.play().catch(e => console.log("Autoplay blocked"));
  }).catch(e => console.error('Shaka load error', e));

  const logo = document.createElement('img');
  logo.className = 'shaka-logo';
  logo.alt = 'WinStrike logo';
  logo.src = 'https://d1gvwx1uptx1i3.cloudfront.net/khelocdn/public/assets/general_setting/winstrike/logo.png';
  container.appendChild(logo);
}
  </script>
</body>
</html>
