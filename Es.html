<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JWPlayer Token Handler</title>
  <script src="https://content.jwplatform.com/libraries/SAHhwvZq.js"></script>
  <style>
    body {
      margin: 0;
      background: #000;
    }
    #player {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="player"></div>

  <script>
    jwplayer.key = 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo';

    function setCookie(name, value) {
      document.cookie = name + "=" + value + "; path=/";
    }

    function extractTokenFromLink(link) {
      const match = link.match(/hdnea=([^&]+)/);
      return match ? match[1] : '';
    }

    function interceptNetworkRequests(token) {
      const originalOpen = XMLHttpRequest.prototype.open;
      XMLHttpRequest.prototype.open = function (method, url) {
        if (url.startsWith('https://tv.media.jio.com/')) {
          url = url.replace('tv.media.jio.com', 'your.proxy.if.want.to.play.worldwide.otherwise.remains.same');
        }

        if ((url.includes('.dash') || url.includes('.m3u8') || url.includes('.ts')) && token && !url.includes('hdnea=')) {
          url += (url.includes('?') ? '&' : '?') + 'hdnea=' + token;
        }

        originalOpen.apply(this, arguments);
      };
    }

    function playVideo() {
      const link = "https://jiotvmblive.cdn.jio.com/bpk-tv/Star_Sports_1_BTS/output/index.mpd?__hdnea__=st=1756432438~exp=1756518838~acl=/*~hmac=8edea7cab50a50c0014b54d7a193a7e00bd2f8fdc7ae7c84a386352ce9a56fec&xxx=%7Ccookie=__hdnea__=st=1756432438~exp=1756518838~acl=/*~hmac=8edea7cab50a50c0014b54d7a193a7e00bd2f8fdc7ae7c84a386352ce9a56fec";

      const tokenValue = extractTokenFromLink(link);
      if (tokenValue) {
        setCookie("hdnea", tokenValue);
        interceptNetworkRequests(tokenValue);
      }

      const playerInstance = jwplayer("player");
      playerInstance.setup({
        playlist: [{
          file: link,
          type: "dash"
        }],
        width: "100%",
        aspectratio: "16:9",
        autostart: true,
        cast: {
          appid: 'CC1AD845'
        }
      });

      playerInstance.on('beforePlay', function () {
        interceptNetworkRequests(tokenValue);
      });
    }

    window.onload = playVideo;

    window.addEventListener("load", function () {
      setTimeout(() => {
        const result = window.confirm("📣 Join our Telegram Channel for more free links and updates!");
        if (result) {
          window.location.href = "https://t.me/your_channel"; // 🔁 Replace with your actual Telegram link
        }
      }, 1000); // Delay to ensure JWPlayer starts first
    });
  </script>
</body>
</html>
