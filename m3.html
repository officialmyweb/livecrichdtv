<!DOCTYPE html>
<html lang="en">
<head>
  <title>Live Stream Player</title>

  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="referrer" content="origin">

  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/plyr@3.6.12/dist/plyr.css"/>

  <style>
    body {
      margin: 0;
      background: #000;
      height: 100vh;
      overflow: hidden;
    }
    video {
      width: 100%;
      height: 100%;
    }
    .plyr {
      height: 100%;
    }
  </style>
</head>
<body>

<video id="player"
       autoplay
       muted
       controls
       playsinline
       crossorigin></video>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/plyr@3.6.12/dist/plyr.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const video = document.getElementById("player");

  const streamUrl =
    "https://media.onestream.live/mumbai-1/content/hls/live_4909699.m3u8?auth=p_49096999_y2k721z_z2xc5h51h";

  if (Hls.isSupported()) {

    const hls = new Hls({
      maxBufferLength: 30,

      xhrSetup: function (xhr, url) {

        // Allowed custom headers (if CORS allows)
        xhr.setRequestHeader("Referer", "https://ap.lbstsirp");
        xhr.setRequestHeader("X-Origin-Header", "south-asia");
        xhr.setRequestHeader("vKey", "auth_4909699");

        // These are protected headers (browser ignores override)
        try {
          xhr.setRequestHeader("Origin", "https://ap.lbstsirp");
          xhr.setRequestHeader("User-Agent",
            "Mozilla/5.0 (Linux; Android 10) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
          );
        } catch (e) {
          console.log("Some headers cannot be modified.");
        }

      }
    });

    hls.loadSource(streamUrl);
    hls.attachMedia(video);

    hls.on(Hls.Events.MANIFEST_PARSED, function () {
      video.play().catch(err => console.log("Autoplay blocked:", err));
    });

    hls.on(Hls.Events.ERROR, function (event, data) {
      console.log("HLS Error:", data);
    });

  } 
  else if (video.canPlayType("application/vnd.apple.mpegurl")) {

    video.src = streamUrl;

    video.addEventListener("loadedmetadata", function () {
      video.play();
    });

  } 
  else {
    document.body.innerHTML =
      "<p style='color:white;text-align:center'>Your browser does not support HLS playback.</p>";
  }

  new Plyr(video);

});
</script>

</body>
</html>
