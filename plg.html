<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<title>Telegram-Live-Cric-Hd</title>

<!-- Shaka Player -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/shaka-player.ui.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/controls.min.css" crossorigin="anonymous">

<!-- Your CSS -->
<link rel="stylesheet" href="https://livecrichdofficial.pages.dev/livecrichd2.css">

<!-- Stream Data -->
<script src="sknzx.js"></script>

<style>
.logo{
    position:absolute;
    top:12px;
    right:12px;
    width:70px;
    z-index:20;
    opacity:0.85;
    cursor:pointer;
}
.ad-overlay{
    position:absolute;
    bottom:90px;
    right:20px;
    background:rgba(0,0,0,.75);
    color:#fff;
    padding:10px 14px;
    border-radius:6px;
    font-size:14px;
    z-index:30;
    display:none;
}
.ad-overlay a{color:#00eaff;text-decoration:none;font-weight:bold;}
.lower-third{
    position:absolute;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,.8);
    color:#fff;
    padding:12px 20px;
    border-radius:8px;
    font-size:16px;
    z-index:25;
    display:none;
}
</style>
</head>

<body>

<div id="player-container">
    <div data-shaka-player-container class="shaka-video-container">
        <video autoplay playsinline data-shaka-player id="video"></video>

        <!-- Overlay Ads -->
        <div class="ad-overlay" id="overlayAd">
            Sponsored by <a href="https://telegram.me/livecrichdofficial" target="_blank">LiveCricHD</a>
        </div>

        <div class="lower-third" id="lowerThird">
            üèè Match Powered by LiveCricHD
        </div>
    </div>
</div>

<script>
/* Domain Lock */
const allowedDomain = "livecrichdtv.pages.dev";
if (window.top !== window.self || location.hostname !== allowedDomain) {
    window.top.location.href = "https://telegram.me/livecrichdofficial";
}

/* Telegram Prompt */
if (confirm("Join Our Telegram Channel @livecrichdofficial")) {
    window.location.href = "https://telegram.me/livecrichdofficial";
}

/* Decryption */
const decryptionKey = "gf676rc7gr4grg78r6ag56gg8f76713f";
function decryptBase64(encodedStr, key){
    const decoded = atob(encodedStr);
    let out = '';
    for(let i=0;i<decoded.length;i++){
        out += String.fromCharCode(decoded.charCodeAt(i) ^ key.charCodeAt(i % key.length));
    }
    return JSON.parse(out);
}

/* URL Param */
function getURLParameter(name){
    return new URLSearchParams(location.search).get(name);
}

const id = getURLParameter("id");
if(!encodedChannelData[id]){
    alert("Invalid ID!");
    location.href="https://telegram.me/livecrichdofficial";
}

const selectedData = decryptBase64(encodedChannelData[id], decryptionKey);

/* INIT PLAYER */
async function initPlayer(){
    const video = document.getElementById("video");
    const ui = video['ui'];
    const controls = ui.getControls();
    const player = controls.getPlayer();

    ui.configure({
        controlPanelElements:[
            'play_pause','mute','spacer','time_and_duration',
            'quality','fullscreen','picture_in_picture','overflow_menu'
        ]
    });

    player.configure({
        drm:{ clearKeys:selectedData.DRMKeys }
    });

    addLogo();
    initAds(video);

    await playWithPreroll(player);
}

/* LOGO */
function addLogo(){
    const logo = document.createElement("img");
    logo.src="https://i.ibb.co/7VF2dfy/1000000077-removebg-preview.png";
    logo.className="logo";
    logo.onclick=()=>location.href="https://telegram.me/livecrichdofficial";
    document.querySelector(".shaka-video-container").appendChild(logo);
}

/* ADS */
function initAds(video){
    const overlay = document.getElementById("overlayAd");
    const lower = document.getElementById("lowerThird");

    setInterval(()=>{
        overlay.style.display="block";
        setTimeout(()=>overlay.style.display="none",10000);
    },180000);

    video.addEventListener("timeupdate",()=>{
        if(Math.floor(video.currentTime)===60){
            lower.style.display="block";
            setTimeout(()=>lower.style.display="none",12000);
        }
    });
}

/* PRE-ROLL */
async function playWithPreroll(player){
    const ad = "https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8"; // OPTIONAL
    try{
        await player.load(ad);
        player.getMediaElement().onended = async()=>{
            await player.load(selectedData.ManifestURI);
        };
    }catch{
        await player.load(selectedData.ManifestURI);
    }
}

document.addEventListener('shaka-ui-loaded', initPlayer);
</script>

</body>
</html>
