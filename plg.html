<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<title>Telegram-Live-Cric-Hd</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/shaka-player.ui.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.6/controls.min.css" crossorigin="anonymous">

<link rel="stylesheet" href="https://livecrichdofficial.pages.dev/livecrichd2.css">
<script src="https://lchdxfootball.pages.dev/sknzx.js"></script>

<style>
.logo{
    position:absolute;
    top:12px;
    right:12px;
    width:70px;
    z-index:30;
    opacity:.85;
    cursor:pointer;
}
.ad-overlay{
    position:absolute;
    bottom:100px;
    right:20px;
    background:rgba(0,0,0,.8);
    color:#fff;
    padding:10px 14px;
    border-radius:6px;
    font-size:14px;
    z-index:40;
    display:none;
}
.lower-third{
    position:absolute;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,.8);
    color:#fff;
    padding:12px 20px;
    border-radius:8px;
    font-size:16px;
    z-index:35;
    display:none;
}
.skip-btn{
    position:absolute;
    bottom:160px;
    right:20px;
    z-index:50;
    padding:8px 14px;
    font-size:14px;
    background:#000;
    color:#fff;
    border:1px solid #fff;
    cursor:pointer;
}
</style>
</head>

<body>

<div id="player-container">
<div data-shaka-player-container class="shaka-video-container">
    <video autoplay playsinline data-shaka-player id="video"></video>

    <div class="ad-overlay" id="overlayAd">
        Sponsored by <b>LiveCricHD</b>
    </div>

    <div class="lower-third" id="lowerThird">
        üèè Match Powered by LiveCricHD
    </div>
</div>
</div>

<script>
/* DOMAIN LOCK */
const allowedDomain="livecrichdtv.pages.dev";
if(window.top!==window.self || location.hostname!==allowedDomain){
    location.href="https://telegram.me/livecrichdofficial";
}

/* TELEGRAM PROMPT */
if(confirm("Join Our Telegram Channel @livecrichdofficial")){
    location.href="https://telegram.me/livecrichdofficial";
}

/* DECRYPT */
const decryptionKey="gf676rc7gr4grg78r6ag56gg8f76713f";
function decryptBase64(e,k){
    const d=atob(e);let o='';
    for(let i=0;i<d.length;i++){
        o+=String.fromCharCode(d.charCodeAt(i)^k.charCodeAt(i%k.length));
    }
    return JSON.parse(o);
}

function getURLParameter(n){
    return new URLSearchParams(location.search).get(n);
}

const id=getURLParameter("id");
if(!encodedChannelData[id]){
    alert("Invalid ID");
    location.href="https://telegram.me/livecrichdofficial";
}
const selectedData=decryptBase64(encodedChannelData[id],decryptionKey);

/* INIT PLAYER */
async function initPlayer(){
    const video=document.getElementById("video");
    const ui=video['ui'];
    const controls=ui.getControls();
    const player=controls.getPlayer();

    ui.configure({
        controlPanelElements:[
            'play_pause','mute','spacer',
            'time_and_duration','quality','fullscreen'
        ]
    });

    player.configure({
        drm:{clearKeys:selectedData.DRMKeys}
    });

    addLogo();
    initAds(video);
    await playWithPreroll(player);
}

/* LOGO */
function addLogo(){
    const img=document.createElement("img");
    img.src="https://i.ibb.co/7VF2dfy/1000000077-removebg-preview.png";
    img.className="logo";
    img.onclick=()=>location.href="https://telegram.me/livecrichdofficial";
    document.querySelector(".shaka-video-container").appendChild(img);
}

/* OVERLAY + LOWER THIRD */
function initAds(video){
    const overlay=document.getElementById("overlayAd");
    const lower=document.getElementById("lowerThird");

    setInterval(()=>{
        overlay.style.display="block";
        setTimeout(()=>overlay.style.display="none",10000);
    },180000);

    video.addEventListener("timeupdate",()=>{
        if(Math.floor(video.currentTime)===60){
            lower.style.display="block";
            setTimeout(()=>lower.style.display="none",12000);
        }
    });
}

/* PRE-ROLL WITH SKIP + GUARANTEED LOAD */
async function playWithPreroll(player){
    const AD_MPD_URL="https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8";   // üîÅ finite ad
    const MAIN_MPD=selectedData.ManifestURI;
    const container=document.querySelector(".shaka-video-container");

    let switched=false;
    const skip=document.createElement("button");
    skip.className="skip-btn";
    skip.textContent="Skip Ad (5)";
    container.appendChild(skip);

    let count=5;
    const timer=setInterval(()=>{
        count--;
        skip.textContent=count>0?`Skip Ad (${count})`:"Skip Ad";
        if(count<=0){
            skip.onclick=loadMain;
            clearInterval(timer);
        }
    },1000);

    function loadMain(){
        if(switched) return;
        switched=true;
        skip.remove();
        player.load(MAIN_MPD);
    }

    try{
        await player.load(AD_MPD_URL);
        setTimeout(loadMain,15000); // failsafe
    }catch{
        loadMain();
    }
}

document.addEventListener("shaka-ui-loaded",initPlayer);
</script>

</body>
</html>
