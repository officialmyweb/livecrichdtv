<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ISL 2025-26 Live</title>
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f172a;
  color:white;
  text-align:center;
}

header{
  background:#1e293b;
  padding:15px;
  font-size:22px;
  font-weight:bold;
}

.match{
  margin:20px auto;
  padding:20px;
  background:#1e293b;
  width:90%;
  max-width:900px;
  border-radius:10px;
  box-shadow:0 0 15px rgba(0,0,0,0.5);
}

button{
  margin:5px;
  padding:10px 15px;
  border:none;
  border-radius:6px;
  background:#2563eb;
  color:white;
  cursor:pointer;
  font-weight:bold;
}

button:hover{
  background:#1d4ed8;
}

.qualities{
  margin-top:10px;
}

iframe{
  margin-top:20px;
  width:90%;
  max-width:900px;
  height:500px;
  border:none;
  border-radius:10px;
  background:black;
}

.upcoming{
  color:#facc15;
  font-weight:bold;
  margin-top:10px;
}
</style>
</head>
<body>

<header>ISL 2025-26 Live Matches</header>

<div id="content"></div>

<iframe id="player"></iframe>

<script>
const workerURL = "https://isl2026.xojiv79335.workers.dev/";

fetch(workerURL)
.then(res => res.json())
.then(data => {

  const container = document.getElementById("content");

  // Group by match title
  const grouped = {};

  data.matches.forEach(match => {
    if(!grouped[match.title]){
      grouped[match.title] = [];
    }
    grouped[match.title].push(match);
  });

  Object.keys(grouped).forEach(title => {

    const matchDiv = document.createElement("div");
    matchDiv.className = "match";

    const titleEl = document.createElement("h2");
    titleEl.innerText = title;
    matchDiv.appendChild(titleEl);

    const matches = grouped[title];

    // Check if all are NOT_STARTED
    const isUpcoming = matches.every(m => m.status === "NOT_STARTED");

    if(isUpcoming){
      const up = document.createElement("div");
      up.className = "upcoming";
      up.innerText = "Upcoming Soon";
      matchDiv.appendChild(up);
      container.appendChild(matchDiv);
      return;
    }

    matches.forEach(match => {

      if(match.status !== "LIVE") return;

      const langBtn = document.createElement("button");
      langBtn.innerText = match.language;

      const qualityDiv = document.createElement("div");
      qualityDiv.className = "qualities";

      langBtn.onclick = () => {

        qualityDiv.innerHTML = "";

        Object.keys(match.streams).forEach(q => {
          const qBtn = document.createElement("button");
          qBtn.innerText = q;

          qBtn.onclick = () => {
            document.getElementById("player").src = match.streams[q];
          };

          qualityDiv.appendChild(qBtn);
        });

      };

      matchDiv.appendChild(langBtn);
      matchDiv.appendChild(qualityDiv);

    });

    container.appendChild(matchDiv);

  });

});
</script>

</body>
</html>
